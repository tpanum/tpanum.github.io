<!doctype html><html lang=en><head><meta charset=utf-8><title>Thomas Kobber Panum</title>
<meta name=author content="Thomas Kobber Panum"><meta name=viewport content="width=device-width,initial-scale=1,minimum-scale=.5"><link rel=stylesheet href=/css/style.8481ff75d2cc9d5e1360fc2d54146ae56d20a0750513e9a7748f058a662d79e3.css integrity="sha256-hIH/ddLMnV4TYPwtVBRq5W0goHUFE+mndI8FimYteeM="></head><body><div class=headerbck></div><div id=grid><header><a href=https://panum.dk/><picture><source type=image/webp srcset="/img/me_x1.webp 1x, /img/me_x2.webp 2x"><source type=image/png srcset="/img/me_x1.png 1x, /img/me_x2.png 2x"><img src=https://panum.dk/img/me_x1.png alt="Thomas Kobber Panum"></picture><h2>Thomas Kobber Panum</h2></a><nav><ul><li class=active><a href=/blog/>Blog</a></li><li>&#183;</li><li><a href=/press/>Press</a></li><li>&#183;</li><li><a href=/academia/>Academia</a></li><li>&#183;</li><li><a href=/teaching/>Teaching</a></li><li>&#183;</li><li><a href=/contact/>Contact</a></li></ul></nav></header><main class=blog><h1 class=title>Disable Bouncer Playback Spam for Emacs Circe Notifications</h1><span class=date>August 10, 2018 &mdash; Thomas Kobber Panum</span><p>I recently changed to using <a href=https://github.com/jorgenschaefer/circe>circe</a> as my everyday IRC client.
Despite the <a href=https://github.com/eqyiel/circe-notifications>circe-notifications</a> being featureful, the suggested way to reduce notification spam from your irc bouncer is a bit of a hack.
As stated in the readme, simply delay the activation hook by <em>x</em> seconds and pray it is large enough for missing all notifcations during playback.</p><div style=text-align:center><picture><source srcset="/blog/disable-bouncer-playback-spam-for-emacs-circe-notifications/images/team_chat_hu123e2bcb05f7bf2d47616d3d46e03238_44182_700x0_resize_q90_h2_box_3.webp 1x, /blog/disable-bouncer-playback-spam-for-emacs-circe-notifications/images/team_chat_hu123e2bcb05f7bf2d47616d3d46e03238_44182_1400x0_resize_q90_h2_box_3.webp 2x" type=image/webp><img srcset="/blog/disable-bouncer-playback-spam-for-emacs-circe-notifications/images/team_chat_hu123e2bcb05f7bf2d47616d3d46e03238_44182_700x0_resize_q90_box_3.png 1x, /blog/disable-bouncer-playback-spam-for-emacs-circe-notifications/images/team_chat_hu123e2bcb05f7bf2d47616d3d46e03238_44182_1400x0_resize_q90_box_3.png 2x" src=/blog/disable-bouncer-playback-spam-for-emacs-circe-notifications/images/team_chat_hu123e2bcb05f7bf2d47616d3d46e03238_44182_700x0_resize_q90_box_3.png width=700 height=299 alt="Team Chat" loading=lazy></picture></div><p>From my experience it works reasonably well, however, when you work on a laptop (with <code>circe-lagmon-mode</code> for reconnection after suspend) the issue persist as you reconnect to your bouncer in the same emacs session.
I am using ZNC as my bouncer, and it conviently prefixes all messages with a timestamp.
Knowing this, I customized <code>circe-notifications-notify</code> to ignore messages with such a prefix.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-lisp data-lang=lisp><span class=line><span class=cl><span class=p>(</span><span class=nb>defun</span> <span class=nv>circe-notifications-notify</span> <span class=p>(</span><span class=nv>nick</span> <span class=nv>body</span> <span class=nv>channel</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>(</span><span class=nb>unless</span> <span class=p>(</span><span class=nv>string-match</span> <span class=s>&#34;^\[[0-9]+:[0-9]+\]&#34;</span> <span class=nv>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=p>(</span><span class=nv>alert</span>
</span></span><span class=line><span class=cl>       <span class=nv>body</span>
</span></span><span class=line><span class=cl>       <span class=ss>:severity</span> <span class=nv>circe-notifications-alert-severity</span>
</span></span><span class=line><span class=cl>       <span class=ss>:title</span> <span class=nv>nick</span>
</span></span><span class=line><span class=cl>       <span class=ss>:style</span> <span class=nv>circe-notifications-alert-style</span><span class=p>)))</span>
</span></span></code></pre></div></main><footer><p>©
<span>2025</span>
<span>Thomas Kobber Panum, theme is heavily inspired by <a href=https://ruben.verborgh.org target=_blank rel=noopener>Ruben Verborgh's website.</a></span><br>Content of this website, text and images, is licensed under <a href=https://creativecommons.org/licenses/by/4.0/ target=_blank title="Creative Commons Attribution 4.0 International License"><abbr class=caps>CC</abbr> <abbr class=caps>BY</abbr> 4.0</a> except where otherwise noted.</p><ul class=profiles><li><a data-icon= href=https://twitter.com/tpanum target=_blank rel=noopener>Twitter</a></li><li><a data-icon= href=https://github.com/tpanum target=_blank rel=noopener>GitHub</a></li><li><a data-icon= href=https://www.linkedin.com/in/tpanum target=_blank rel=noopener>LinkedIn</a></li></ul></footer></div><script>document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("pre").forEach(function(e){var t=document.createElement("button");t.className="copy-btn",t.setAttribute("aria-label","Copy code"),t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>',t.addEventListener("click",function(){var n=e.querySelector("code")||e;navigator.clipboard.writeText(n.textContent).then(function(){t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>',setTimeout(function(){t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>'},2e3)})}),e.style.position="relative",e.appendChild(t)})})</script></body></html>